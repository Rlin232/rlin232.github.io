---
import '../styles/global.css';

interface Props {
	title: string;
	description?: string;
	hideFooter?: boolean;
}

const { title, description = "Ryan Lin â€“ AI/ML researcher, developer, and Caltech student. Explore my projects, publications, and CV.", hideFooter = false } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/assets/img/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<meta name="description" content={description} />
		<title>{title}</title>

		<!-- Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

		<!-- AOS Animation Library -->
		<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

		<script type="text/partytown" async src="https://www.googletagmanager.com/gtag/js?id=G-3M9BV2QREG"></script>
		<script type="text/partytown">
			window.dataLayer = window.dataLayer || [];
			function gtag() {
			window.dataLayer.push(arguments);
			}
			gtag('js', new Date());
			gtag('config', 'G-3M9BV2QREG');
		</script>
	</head>
	<body class="min-h-full bg-slate-950 text-slate-100 font-inter selection:bg-accent-500 selection:text-white overflow-x-hidden">
		<div id="tsparticles" class="fixed inset-0 w-full h-full pointer-events-none z-0"></div>
		
		<!-- Background Gradient Mesh -->
		<div class="fixed inset-0 z-0 opacity-30 pointer-events-none bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-accent-900/40 via-slate-950 to-slate-950"></div>
		<div class="fixed inset-0 z-0 opacity-20 pointer-events-none bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-blue-900/40 via-slate-950 to-slate-950"></div>

		<div class="relative z-10 min-h-full flex flex-col">
			<nav class="fixed w-full z-50 transition-all duration-300" id="navbar" x-data="{ open: false, scrolled: false }" 
				@scroll.window="scrolled = (window.pageYOffset > 20)">
				<div class="absolute inset-0 bg-slate-950/70 backdrop-blur-md border-b border-white/5 transition-opacity duration-300"
					 :class="{ 'opacity-100': scrolled, 'opacity-0': !scrolled && !open }"></div>
				
				<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
					<div class="flex justify-between h-20 items-center">
						<!-- Left side (Logo/Home) -->
						<div class="flex items-center">
							<a href="/" class="group flex items-center space-x-2 text-xl font-bold font-outfit tracking-tight hover:text-accent-400 transition-colors duration-300">
								<span class="bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400 group-hover:from-accent-400 group-hover:to-accent-200 transition-all duration-300">RL</span>
							</a>
						</div>
	
						<!-- Desktop Menu -->
						<div class="hidden sm:flex items-center space-x-1">
							<a href="/publications" class="nav-link px-4 py-2 rounded-full text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 transition-all duration-300">Publications</a>
							<a href="/projects" class="nav-link px-4 py-2 rounded-full text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 transition-all duration-300">Projects</a>
							<a href="/cv" class="nav-link px-4 py-2 rounded-full text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 transition-all duration-300">CV</a>
							
							<!-- Theme Toggle (Hidden for now as we are enforcing dark mode for the 'sleek' look, but keeping code if needed later) -->
							<!-- <button ... > -->
						</div>
	
						<!-- Hamburger Button -->
						<button @click="open = !open" class="sm:hidden p-2 rounded-lg text-slate-300 hover:text-white hover:bg-white/10 focus:outline-none transition-colors">
							<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
							</svg>
						</button>
					</div>
				</div>
	
				<!-- Mobile Menu -->
				<div x-show="open" 
					 x-transition:enter="transition ease-out duration-200"
					 x-transition:enter-start="opacity-0 -translate-y-2"
					 x-transition:enter-end="opacity-100 translate-y-0"
					 x-transition:leave="transition ease-in duration-150"
					 x-transition:leave-start="opacity-100 translate-y-0"
					 x-transition:leave-end="opacity-0 -translate-y-2"
					 class="sm:hidden absolute w-full bg-slate-950/95 backdrop-blur-xl border-b border-white/10">
					<div class="px-4 pt-2 pb-4 space-y-1">
						<a href="/publications" class="block px-4 py-3 rounded-lg text-base font-medium text-slate-300 hover:text-white hover:bg-white/5">Publications</a>
						<a href="/projects" class="block px-4 py-3 rounded-lg text-base font-medium text-slate-300 hover:text-white hover:bg-white/5">Projects</a>
						<a href="/cv" class="block px-4 py-3 rounded-lg text-base font-medium text-slate-300 hover:text-white hover:bg-white/5">CV</a>
					</div>
				</div>
			</nav>
			
			<main class="flex-grow pt-20">
				<slot />
			</main>

			{!hideFooter && (
			<footer class="border-t border-white/5 bg-slate-950/50 backdrop-blur-sm mt-auto">
				<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
					<div class="flex flex-col md:flex-row justify-between items-center">
						<div class="text-slate-500 text-sm">
							&copy; {new Date().getFullYear()} Ryan Lin. All rights reserved.
						</div>
						<div class="flex space-x-6 mt-4 md:mt-0">
							<!-- Footer Socials can go here -->
						</div>
					</div>
				</div>
			</footer>
			)}
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.8/cdn.min.js" defer></script>
		<script is:inline src="https://cdn.jsdelivr.net/npm/tsparticles-slim@2.0.6/tsparticles.slim.bundle.min.js"></script>
		<script is:inline src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
		
		<script is:inline>
			// Initialize AOS
			AOS.init({
				duration: 400,
				once: true,
				offset: 10,
				easing: 'ease-out-cubic',
			});

			// Particles configuration
			document.addEventListener('DOMContentLoaded', async function() {
				try {
					await tsParticles.load("tsparticles", {
						fullScreen: { enable: false },
						background: { color: { value: "transparent" } },
						fpsLimit: 60,
						particles: {
							number: {
								value: 40,
								density: { enable: true, value_area: 800 }
							},
							color: { value: "#ffffff" },
							shape: { type: "circle" },
							opacity: {
								value: 0.5,
								random: true,
								anim: { enable: true, speed: 0.5, opacity_min: 0.2, sync: false }
							},
							size: {
								value: 2,
								random: true,
								anim: { enable: true, speed: 2, size_min: 0.1, sync: false }
							},
							links: {
								enable: true,
								distance: 150,
								color: "#ffffff",
								opacity: 0.2,
								width: 1
							},
							move: {
								enable: true,
								speed: 0.8,
								direction: "none",
								random: false,
								straight: false,
								out_mode: "out",
								bounce: false,
							}
						},
						interactivity: {
							detect_on: "canvas",
							events: {
								onHover: { enable: true, mode: "grab" },
								onClick: { enable: true, mode: "push" },
								resize: true
							},
							modes: {
								grab: { distance: 140, links: { opacity: 0.3 } },
								push: { particles_nb: 4 }
							}
						},
						detectRetina: true
					});
				} catch (error) {
					console.error("Error initializing particles:", error);
				}
			});
		</script>
	</body>
</html>

<style is:global>
	:root {
		--accent-50: #f0f9ff;
		--accent-100: #e0f2fe;
		--accent-200: #bae6fd;
		--accent-300: #7dd3fc;
		--accent-400: #38bdf8;
		--accent-500: #0ea5e9;
		--accent-600: #0284c7;
		--accent-700: #0369a1;
		--accent-800: #075985;
		--accent-900: #0c4a6e;
	}

	html {
		font-family: 'Inter', system-ui, sans-serif;
		background-color: #020617; /* slate-950 */
		color: #f8fafc; /* slate-50 */
	}

	h1, h2, h3, h4, h5, h6 {
		font-family: 'Outfit', system-ui, sans-serif;
	}

	/* Custom Scrollbar */
	::-webkit-scrollbar {
		width: 10px;
	}

	::-webkit-scrollbar-track {
		background: #020617;
	}

	::-webkit-scrollbar-thumb {
		background: #1e293b;
		border-radius: 5px;
	}

	::-webkit-scrollbar-thumb:hover {
		background: #334155;
	}

	/* Utility for glass cards */
	.glass-card {
		background: rgba(255, 255, 255, 0.03);
		backdrop-filter: blur(10px);
		border: 1px solid rgba(255, 255, 255, 0.05);
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
	}
	
	.glass-card:hover {
		background: rgba(255, 255, 255, 0.05);
		border-color: rgba(255, 255, 255, 0.1);
	}
</style>
